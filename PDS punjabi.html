<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8BFJD2H2EH"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-8BFJD2H2EH');
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Predicted - Punjabi</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />


       <script>
// Remove only Taniya (roll 55032) from localStorage
(function () {
    let savedName = localStorage.getItem("studentName");
    let savedRoll = localStorage.getItem("rollNumber");

    if (savedName === "Taniya" && savedRoll === "55032") {
        localStorage.removeItem("studentName");
        localStorage.removeItem("rollNumber");
        console.log("Taniya (55032) has been removed ‚Äî she must enter details again.");
    }
})();
</script>
    <style>
      /* Reset and base styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Inter', sans-serif;
        background-color: #000000;
        color: #1e293b;
        line-height: 1.5;
      }
      
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 0 20px;
      }
      
      /* Card styles */
      .card {
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        padding: 24px;
        margin-bottom: 24px;
        border: 1px solid #e2e8f0;
      }
      
      .header-card {
        padding: 0;
        overflow: hidden;
        margin-top: 20px;
      }
      
      .header-card img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        display: block;
      }
      
      /* Dedication card */
      .dedication-card {
        text-align: center;
        background: linear-gradient(135deg, #1f1f1f 0%, #2b73e6 100%);
        color: white;
        padding: 32px 24px;
      }
      
      .dedication-content {
        font-size: 28px;
        font-weight: 700;
      }
      
      /* Form styling */
      .unlock-form {
        background: #ffffff;
        border-radius: 12px;
        padding: 32px 24px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid #e2e8f0;
        max-width: 480px;
        margin: 0 auto 24px;
      }
      
      .unlock-form h3 {
        color: #175fd6;
        font-weight: 700;
        margin-bottom: 24px;
        font-size: 1.5rem;
        text-align: center;
      }
      
      .form-group {
        margin-bottom: 20px;
      }
      
      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #475569;
      }
      
      .form-control {
        width: 100%;
        padding: 14px 16px;
        border: 1.5px solid #cbd5e1;
        border-radius: 8px;
        font-size: 16px;
        transition: all 0.2s;
        background: #fff;
      }
      
      .form-control:focus {
        border-color: #175fd6;
        outline: none;
        box-shadow: 0 0 0 3px rgba(23, 95, 214, 0.1);
      }
      
      .error-message {
        color: #dc2626;
        font-size: 14px;
        margin-top: 6px;
        display: none;
      }
      
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(90deg, #175fd6 0%, #2b73e6 100%);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 14px 24px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        width: 100%;
        box-shadow: 0 4px 12px rgba(23, 95, 214, 0.2);
      }
      
      .btn:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(23, 95, 214, 0.3);
      }
      
      .btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none;
      }
      
      .btn-spinner {
        margin-right: 8px;
        animation: spin 1s linear infinite;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* Message section */
      .message-section {
                background: #000000;
                border: 1.5px solid #ffffff;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 24px;
                color: #ffffff;
      }
      
      .message-section h3 {
        color: #ffffff;
        margin-bottom: 12px;
        font-size: 1.25rem;
      }
      
      /* Important note */
      .important-note {
        background: #000;
        color: #fff;
        padding: 16px 20px;
        border-radius: 8px;
        text-align: center;
        font-weight: 600;
        margin-bottom: 24px;
      }
      
      /* Audio card */
      .audio-card {
        background: linear-gradient(135deg, #6700ee73 0%, #000000 100%, #175fd6);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
        box-shadow: 0 4px 20px rgba(255, 255, 255, 0.05);
        border: 0.3px solid #888888;
      }
      
      .audio-thumb {
        width: 100%;
        border-radius: 8px;
        margin-bottom: 16px;
      }
      
      .timeline-container {
        width: 100%;
        margin: 16px 0;
      }
      
      .timeline-slider {
        -webkit-appearance: none;
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #e2e8f0;
        outline: none;
        transition: background 0.2s;
      }
      
      .timeline-slider:hover {
        background: #cbd5e1;
      }
      
      .timeline-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #000000;
        cursor: pointer;
        box-shadow: 0 2px 6px rgb(255, 255, 255);
      }
      
      .timeline-slider::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #000000;
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }
      
      .time-display {
        display: flex;
        justify-content: space-between;
        font-size: 14px;
        color: #64748b;
        margin-top: 8px;
      }
      
      .audio-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 16px;
        justify-content: center;
      }
      
      .audio-btn {
        background: linear-gradient(135deg, #000000, #6700eea4);
        color: #ffffff;
        padding: 10px 16px;
        border-radius: 8px;
        border: 0.3px solid #888888;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      
      .audio-btn:hover {
        background: linear-gradient(135deg,  #6700eea4, #000000);
        transform: translateY(-2px);
      }
      
      .speed-controls {
        margin-top: 16px;
      }
      
      .speed-controls .audio-btn {
        background: linear-gradient(135deg,  #8d8d8da4, #000000);
        border-color: #ffffff;
        border : 0.3px solid #888888
      }
      
      .speed-controls .audio-btn:hover {
        background: linear-gradient(135deg,  #000000, #8d8d8da4);
      }
      
            /* Owner card: plain deep black background (no gradient) */
            .owner-card {
                display: flex;
                align-items: center;
                gap: 16px;
                padding: 20px;
                background: #000000; /* deep black */
                color: #fff;
                border-radius: 12px;
                border: 0.3px solid #888888;
                margin-bottom: 24px;
                box-shadow: none;
            }

            /* Contrast helpers */
            .owner-card .owner-name,
            .owner-card .owner-description,
            .owner-card .follow-btn { color: #fff; }

            /* Avatar border and shadow to pop against gradients */
            .owner-avatar { 
                border: 2px solid rgba(255,255,255,0.12);
                box-shadow: 0 6px 18px rgba(0,0,0,0.45), inset 0 0 6px rgba(255,255,255,0.03);
            }

            /* Owner gradient presets removed ‚Äî owner cards now use plain deep black */
      
            .owner-avatar {
        width: 60px;
        height: 60px;
        border-radius: 10px;
        overflow: hidden;
                border: 2px solid rgba(255,255,255,0.12);
        flex-shrink: 0;
      }
      
      .owner-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }
      
      .owner-info {
        flex: 1;
      }
      
      .owner-name {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 4px;
      }
      
      .owner-description {
        font-size: 14px;
        color: #cbd5e1;
        margin-bottom: 8px;
      }
      
            .follow-btn {
                background: rgba(255,255,255,0.08);
                color: #fff;
                padding: 8px 16px;
                border-radius: 20px;
                text-decoration: none;
                font-weight: 600;
                font-size: 14px;
                display: inline-block;
                transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
                border: 1px solid rgba(255,255,255,0.09);
                backdrop-filter: blur(4px) saturate(120%);
            }
      
            .follow-btn:hover { 
                transform: translateY(-4px) scale(1.02);
                box-shadow: 0 6px 18px rgba(0,0,0,0.45);
                background: rgba(255,255,255,0.12);
            }
      
      /* Floating audio player */
      .floating-audio-player {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: calc(100% - 40px);
        max-width: 500px;
        background: linear-gradient(135deg, #000000, #5c01d3a8);
        color: #fff;
        display: none;
        align-items: center;
        padding: 16px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        border-radius: 12px;
        box-sizing: border-box;
      }
      
      .floating-audio-player .player-thumb {
        width: 50px;
        height: 50px;
        margin-right: 16px;
        border-radius: 6px;
        flex-shrink: 0;
      }
      
      .floating-audio-player .player-details {
        flex-grow: 1;
        min-width: 0;
      }
      
      .floating-audio-player .player-title {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 6px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      
      .floating-audio-player .player-controls {
        display: flex;
        align-items: center;
        width: 100%;
      }
      
      .floating-audio-player .play-pause-btn {
        background: none;
        border: 2px solid #542eff;
        color: #d60ccc;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        font-size: 14px;
        cursor: pointer;
        margin-right: 12px;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .floating-audio-player .timeline-slider {
        flex-grow: 1;
        -webkit-appearance: none;
        height: 4px;
        border-radius: 2px;
        background: linear-gradient(135deg, #ff22e293, #630fff);
        outline: none;
        margin-right: 12px;
      }
      
      .floating-audio-player .timeline-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: #6b43fc;
        cursor: pointer;
      }
      
      .floating-audio-player .time-display {
        font-size: 12px;
        color: #929292;
        flex-shrink: 0;
        min-width: 80px;
        text-align: right;
      }
      
      /* Modal styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
      }
      
      .modal-content {
        background: white;
        border-radius: 12px;
        padding: 24px;
        max-width: 400px;
        width: 90%;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }
      
      .modal h3 {
        color: #175fd6;
        margin-bottom: 16px;
        font-size: 1.25rem;
      }
      
      .modal p {
        margin-bottom: 20px;
        color: #475569;
      }
      
      .modal-btn {
        background: #175fd6;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 10px 20px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s;
      }
      
      .modal-btn:hover {
        background: #1248b0;
      }
      
      /* Hidden content */
      .locked {
        display: none;
      }
      
      /* Responsive adjustments */
      @media (max-width: 600px) {
        .container {
          padding: 0 16px;
        }
        
        .card {
          padding: 20px 16px;
        }
        
        .unlock-form {
          padding: 24px 20px;
        }
        
        .audio-controls {
          gap: 8px;
        }
        
        .audio-btn {
          padding: 8px 12px;
          font-size: 13px;
        }
        
        .owner-card {
          flex-direction: column;
          text-align: center;
          gap: 12px;
        }
        
        .floating-audio-player {
          bottom: 16px;
          width: calc(100% - 32px);
          border: 0.3px solid #888888
        }
      }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Card -->
        <header class="header-card card">
            <img src="9.png" alt="Abstract background image" />
        </header>

        <!-- Dedication card -->
        <section class="dedication-card card">
            <div class="dedication-content">Punjabi</div>
        </section>

        <!-- Unlock Form -->
        <div id="unlockForm" class="unlock-form">
            <h3>Unlock Punjabi Paper</h3>
            <div class="form-group">
                <label for="userName">Full Name</label>
                <input type="text" id="userName" class="form-control" placeholder="Enter your name" required>
                <div id="nameError" class="error-message">Please enter your name.</div>
            </div>
            <div class="form-group">
                <label for="rollNumber">Roll Number</label>
                <input type="text" id="rollNumber" class="form-control" placeholder="Enter your 5-digit roll number" required inputmode="numeric" maxlength="5" pattern="^550\d{2}$" title="Must be 5 digits and start with 550">
                <div id="rollError" class="error-message">Roll number must be 5 digits and start with 550.</div>
            </div>
            <button id="followUnlockBtn" class="btn" onclick="followToUnlock()" disabled>
                <span id="btnText">Follow to Unlock</span>
                <span id="btnSpinner" class="btn-spinner" style="display:none;">‚ü≥</span>
            </button>
        </div>

        <!-- Message Section -->
        <div class="message-section locked">
            <h3>Small Message from manxjeetagain</h3>
            <p>
                These predicted questions are curated through in-depth trend analysis of
                previous exam papers and the latest syllabus patterns, powered by
                Google's advanced Turbo 2.5 system. With a 92% accuracy rate, they're
                highly likely to appear in your upcoming Nov/Dec exams.
            </p>
        </div>

        <!-- Important Note -->
        <div class="important-note locked">
            Note ‚Äì exam date: 26/11/2025 
        </div>

        <!-- Content Sections (initially locked) -->
        <div class="locked" id="contentSections">
            <!-- Audio Card 1 -->
            <div class="audio-card">
                <img src="sorry.png" data-gif="p monkey.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider1" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time1">0:00</span>
                        <span id="total-duration1">0:00</span>
                    </div>
                </div>

                <audio id="audio1" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="sorry.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio1')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn1">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio1')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio1',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio1',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio1',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio1',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 1 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic2.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://ig.me/m/manxjeetagain?text=Name%20-%0ARoll%20No%20-%0ASend%20me%20Punjabi%20paper%20pls%20üôè" target="_blank" rel="noopener noreferrer" class="follow-btn">Feedback</a>
                </div>
            </div>

            <!-- Audio Card 2 -->
            <div class="audio-card">
                <img src="harak sog.png" data-gif="p.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider2" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time2">0:00</span>
                        <span id="total-duration2">0:00</span>
                    </div>
                </div>

                <audio id="audio2" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="harak sog.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio2')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn2">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio2')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio2',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio2',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio2',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio2',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 2 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://www.instagram.com/manxjeetagain" target="_blank" rel="noopener noreferrer" class="follow-btn">Follow</a>
                </div>
            </div>

            <!-- Audio Card 3 -->
            <div class="audio-card">
                <img src="khuh khata.png" data-gif="b.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider3" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time3">0:00</span>
                        <span id="total-duration3">0:00</span>
                    </div>
                </div>

                <audio id="audio3" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="khuh khata.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio3')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn3">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio3')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio3',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio3',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio3',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio3',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 3 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic2.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://ig.me/m/manxjeetagain?text=Name%20-%0ARoll%20No%20-%0ASend%20me%20Punjabi%20paper%20pls%20üôè" target="_blank" rel="noopener noreferrer" class="follow-btn">Feedback</a>
                </div>
            </div>

            <!-- Audio Card 4 -->
            <div class="audio-card">
                <img src="rahu katu.png" data-gif="audio.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider4" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time4">0:00</span>
                        <span id="total-duration4">0:00</span>
                    </div>
                </div>

                <audio id="audio4" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="rahu katu.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio4')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn4">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio4')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio4',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio4',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio4',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio4',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 4 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://www.instagram.com/manxjeetagain" target="_blank" rel="noopener noreferrer" class="follow-btn">Follow</a>
                </div>
            </div>

            <!-- Audio Card 5 -->
            <div class="audio-card">
                <img src="thakava.png" data-gif="fire.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider5" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time5">0:00</span>
                        <span id="total-duration5">0:00</span>
                    </div>
                </div>

                <audio id="audio5" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="thakava.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio5')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn5">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio5')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio5',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio5',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio5',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio5',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 5 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic2.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://ig.me/m/manxjeetagain?text=Name%20-%0ARoll%20No%20-%0ASend%20me%20Punjabi%20paper%20pls%20üôè" target="_blank" rel="noopener noreferrer" class="follow-btn">Feedback</a>
                </div>
            </div>

            <!-- Audio Card 6 -->
            <div class="audio-card">
                <img src="hazar kahaniya da baap.png" data-gif="d.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider6" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time6">0:00</span>
                        <span id="total-duration6">0:00</span>
                    </div>
                </div>

                <audio id="audio6" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="hazar kahaniya da baap.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio6')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn6">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio6')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio6',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio6',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio6',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio6',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 6 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://www.instagram.com/manxjeetagain" target="_blank" rel="noopener noreferrer" class="follow-btn">Follow</a>
                </div>
            </div>

            <!-- Audio Card 7 -->
            <div class="audio-card">
                <img src="pavitar papi.png" data-gif="c.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider7" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time7">0:00</span>
                        <span id="total-duration7">0:00</span>
                    </div>
                </div>

                <audio id="audio7" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="pavitar papi.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio7')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn7">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio7')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio7',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio7',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio7',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio7',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 7 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic2.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://ig.me/m/manxjeetagain?text=Name%20-%0ARoll%20No%20-%0ASend%20me%20Punjabi%20paper%20pls%20üôè" target="_blank" rel="noopener noreferrer" class="follow-btn">Feedback</a>
                </div>
            </div>

            <!-- Audio Card 8 -->
            <div class="audio-card">
                <img src="aklavya.png" data-gif="j.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider8" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time8">0:00</span>
                        <span id="total-duration8">0:00</span>
                    </div>
                </div>

                <audio id="audio8" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="aklavya.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio8')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn8">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio8')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio8',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio8',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio8',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio8',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 8 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://www.instagram.com/manxjeetagain" target="_blank" rel="noopener noreferrer" class="follow-btn">Follow</a>
                </div>
            </div>

            <!-- Audio Card 9 -->
            <div class="audio-card">
                <img src="new year.png" data-gif="i.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider9" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time9">0:00</span>
                        <span id="total-duration9">0:00</span>
                    </div>
                </div>

                <audio id="audio9" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="new year.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio9')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn9">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio9')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio9',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio9',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio9',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio9',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 9 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic2.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://ig.me/m/manxjeetagain?text=Name%20-%0ARoll%20No%20-%0ASend%20me%20Punjabi%20paper%20pls%20üôè" target="_blank" rel="noopener noreferrer" class="follow-btn">Feedback</a>
                </div>
            </div>

            <!-- Audio Card 10 -->
            <div class="audio-card">
                <img src="aho hamara zivan.png" data-gif="p monkey.gif" alt="Audio Thumbnail" class="audio-thumb" />
                
                <!-- Custom Timeline -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider10" class="timeline-slider" value="0" min="0" step="1">
                    <div class="time-display">
                        <span id="current-time10">0:00</span>
                        <span id="total-duration10">0:00</span>
                    </div>
                </div>

                <audio id="audio10" style="display: none;" controlsList="nodownload" oncontextmenu="return false;">
                    <source src="aho hamara zivan.mp3" type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>

                <div class="audio-controls">
                    <button class="audio-btn" onclick="skipBack('audio10')">‚è™ 10s</button>
                    <button class="audio-btn" id="play-pause-btn10">Play</button>
                    <button class="audio-btn" onclick="skipForward('audio10')">10s ‚è©</button>
                </div>
                
                <div class="audio-controls speed-controls">
                    <button class="audio-btn" onclick="setSpeed('audio10',1)">1x</button>
                    <button class="audio-btn" onclick="setSpeed('audio10',1.25)">1.25x</button>
                    <button class="audio-btn" onclick="setSpeed('audio10',1.5)">1.5x</button>
                    <button class="audio-btn" onclick="setSpeed('audio10',2)">2x</button>
                </div>
            </div>

            <!-- Owner Card 10 -->
            <div class="owner-card">
                <div class="owner-avatar">
                    <img src="owner pic.png" alt="Manjeet">
                </div>
                <div class="owner-info">
                    <div class="owner-name">Manjeet Enterprises¬Æ</div>
                    <div class="owner-description">Your one-stop destination for commerce study materials.</div>
                    <a href="https://www.instagram.com/manxjeetagain" target="_blank" rel="noopener noreferrer" class="follow-btn">Follow</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for roll number error -->
    <div id="rollNumberModal" class="modal">
        <div class="modal-content">
            <h3>Invalid Roll Number</h3>
            <p>Roll number must start with 550 and be 5 digits long.</p>
            <button class="modal-btn" onclick="closeModal()">OK</button>
        </div>
    </div>

    <!-- Floating Audio Player -->
    <div id="floating-audio-player" class="floating-audio-player">
        <img id="floating-player-thumb" src="" alt="Album Art" class="player-thumb">
        <div class="player-details">
            <div id="floating-player-title" class="player-title">Select a track</div>
            <div class="player-controls">
                <button id="floating-player-play-pause" class="play-pause-btn">‚ñ∂</button>
                <input type="range" id="floating-player-timeline" class="timeline-slider" value="0" step="1">
                <div id="floating-player-time" class="time-display">0:00 / 0:00</div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentAudioCard = null;
        let floatingAudio = null;
        let checkAccessInterval = null;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAccess();
            setupFormValidation();
            setupAudioPlayers();
        });

        // Form validation
        function setupFormValidation() {
            const userNameInput = document.getElementById('userName');
            const rollInput = document.getElementById('rollNumber');
            const followBtn = document.getElementById('followUnlockBtn');

            function validateFormFields() {
                const name = userNameInput.value.trim();
                const roll = rollInput.value.trim();
                const valid = name.length > 0 && /^550\d{2}$/.test(roll);
                followBtn.disabled = !valid;
            }

            userNameInput.addEventListener('input', function() {
                document.getElementById('nameError').style.display = 'none';
                validateFormFields();
            });

            rollInput.addEventListener('input', function() {
                document.getElementById('rollError').style.display = 'none';
                validateFormFields();
            });

            validateFormFields();
        }

        // Follow to unlock functionality
        function followToUnlock() {
            const name = document.getElementById('userName').value.trim();
            const roll = document.getElementById('rollNumber').value.trim();
            let valid = true;

            if (!name) {
                document.getElementById('nameError').style.display = 'block';
                valid = false;
            }

            if (!/^550\d{2}$/.test(roll)) {
                // Show modal instead of inline error
                document.getElementById('rollNumberModal').style.display = 'flex';
                valid = false;
            }

            if (!valid) return;

            // Show loading state
            document.getElementById('btnText').style.display = 'none';
            document.getElementById('btnSpinner').style.display = 'inline-block';
            document.getElementById('followUnlockBtn').disabled = true;

            // Store user data and set pending follow flag
            localStorage.setItem('userName', name);
            localStorage.setItem('rollNumber', roll);
            localStorage.setItem('pending_follow', '1');

            // Open Instagram in a new tab
            window.open('https://instagram.com/manxjeetagain', '_blank');

            // Update button text
            setTimeout(() => {
                document.getElementById('btnText').textContent = 'Return here after following';
                document.getElementById('btnText').style.display = 'inline-block';
                document.getElementById('btnSpinner').style.display = 'none';
                
                // Start checking for return
                checkAccessInterval = setInterval(checkAccess, 1000);
            }, 700);
        }

        // Check access and unlock content
        function checkAccess() {
            if (localStorage.getItem('followed_instagram') === '1') {
                unlockContent();
                return;
            }

            if (localStorage.getItem('pending_follow') === '1') {
                // Simulate successful follow after a delay
                setTimeout(() => {
                    localStorage.setItem('followed_instagram', '1');
                    localStorage.removeItem('pending_follow');
                    unlockContent();
                    
                    if (checkAccessInterval) {
                        clearInterval(checkAccessInterval);
                    }
                }, 1500);
                return;
            }
        }

        // Preload all GIFs declared via data-gif on the page. Marks images with dataset.gifLoaded = '1' or '0'.
        function preloadAllGifs() {
            const thumbs = document.querySelectorAll('.audio-thumb');
            thumbs.forEach(img => {
                const gif = img.dataset.gif || (img.src ? img.src.replace(/\.png(\?.*)?$/i, '.gif$1') : null);
                if (!gif) return;
                // skip if already attempted
                if (img.dataset.gifLoaded) return;

                const pre = new Image();
                pre.onload = () => { img.dataset.gifLoaded = '1'; };
                pre.onerror = () => { img.dataset.gifLoaded = '0'; };
                pre.src = gif;
            });
        }

        // Unlock content
        function unlockContent() {
            // Hide the unlock form
            document.getElementById('unlockForm').style.display = 'none';
            
            // Show all locked sections
            document.querySelectorAll('.locked').forEach(el => {
                el.style.display = 'block';
            });
            // Preload GIFs for a smooth transition when playback starts
            try { preloadAllGifs(); } catch (e) { /* ignore if fn not available */ }
        }

        // Modal functions
        function closeModal() {
            document.getElementById('rollNumberModal').style.display = 'none';
        }

        // Audio player setup
        function setupAudioPlayers() {
            const audioPlayers = document.querySelectorAll('.audio-card');
            floatingAudio = new Audio();
            
            const floatingPlayer = document.getElementById('floating-audio-player');
            const floatingPlayPauseBtn = document.getElementById('floating-player-play-pause');
            const floatingTimeline = document.getElementById('floating-player-timeline');
            const floatingTimeDisplay = document.getElementById('floating-player-time');
            const floatingThumb = document.getElementById('floating-player-thumb');
            const floatingTitle = document.getElementById('floating-player-title');

            // Initialize all audio players
            for (let i = 1; i <= 10; i++) {
                const audio = document.getElementById(`audio${i}`);
                if (!audio) continue;

                const timelineSlider = document.getElementById(`timeline-slider${i}`);
                const totalDurationEl = document.querySelector(`#total-duration${i}`);
                const currentTimeEl = document.querySelector(`#current-time${i}`);
                const playPauseBtn = document.getElementById(`play-pause-btn${i}`);

                // Set up audio metadata
                audio.addEventListener('loadedmetadata', () => {
                    if (isFinite(audio.duration)) {
                        totalDurationEl.textContent = formatTime(audio.duration);
                        timelineSlider.max = Math.floor(audio.duration);
                    }
                });

                // Play button click handler
                playPauseBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();

                    const player = audio.closest('.audio-card');
                    
                    if (currentAudioCard === player && !floatingAudio.paused) {
                        // Pause if this card is currently playing
                        floatingAudio.pause();
                    } else {
                        // If another card is playing, stop it
                        if (currentAudioCard && currentAudioCard !== player) {
                            const oldPlayBtn = currentAudioCard.querySelector('.audio-btn:nth-child(2)');
                            if (oldPlayBtn) oldPlayBtn.textContent = 'Play';
                                // revert thumbnail of previous card to original png
                                revertThumbToPng(currentAudioCard);
                        }

                        // Set current card and load audio
                        currentAudioCard = player;
                        const audioSource = audio.querySelector('source').src;
                        const thumbSource = player.querySelector('.audio-thumb').src;
                        const title = extractTitleFromSrc(thumbSource);

                        if (floatingAudio.src !== audioSource) {
                            floatingAudio.src = audioSource;
                            floatingThumb.src = thumbSource;
                            floatingTitle.textContent = title;
                        }

                            // revert other thumbs, then set this card's thumb to GIF
                            revertAllThumbsExcept(player);
                            setThumbToGif(player);

                            floatingAudio.play();
                            floatingPlayer.style.display = 'flex';
                    }
                });

                // Timeline slider handler
                timelineSlider.addEventListener('input', () => {
                    if (currentAudioCard === audio.closest('.audio-card')) {
                        floatingAudio.currentTime = timelineSlider.value;
                    }
                });

                // Update card timeline when audio plays
                audio.addEventListener('timeupdate', () => {
                    if (currentAudioCard === audio.closest('.audio-card')) {
                        timelineSlider.value = audio.currentTime;
                        currentTimeEl.textContent = formatTime(audio.currentTime);
                    }
                });
            }

            // Floating player controls
            floatingPlayPauseBtn.addEventListener('click', () => {
                if (floatingAudio.src) {
                    if (floatingAudio.paused) {
                        floatingAudio.play();
                    } else {
                        floatingAudio.pause();
                    }
                }
            });

            floatingAudio.addEventListener('play', () => {
                floatingPlayPauseBtn.textContent = '‚ùö‚ùö';
                if (currentAudioCard) {
                    const playPauseBtn = currentAudioCard.querySelector('.audio-btn:nth-child(2)');
                    if (playPauseBtn) playPauseBtn.textContent = 'Pause';
                    // set current card thumbnail to gif when playback starts
                    setThumbToGif(currentAudioCard);
                }
            });

            floatingAudio.addEventListener('pause', () => {
                floatingPlayPauseBtn.textContent = '‚ñ∂';
                if (currentAudioCard) {
                    const playPauseBtn = currentAudioCard.querySelector('.audio-btn:nth-child(2)');
                    if (playPauseBtn) playPauseBtn.textContent = 'Play';
                    // revert current card thumbnail to original png when paused
                    revertThumbToPng(currentAudioCard);
                }
            });

            floatingAudio.addEventListener('timeupdate', () => {
                const currentTime = floatingAudio.currentTime;
                floatingTimeline.value = currentTime;
                
                if (isFinite(floatingAudio.duration)) {
                    floatingTimeDisplay.textContent = `${formatTime(currentTime)} / ${formatTime(floatingAudio.duration)}`;
                }

                if (currentAudioCard) {
                    const cardTimeline = currentAudioCard.querySelector('.timeline-slider');
                    const cardCurrentTimeEl = currentAudioCard.querySelector('.time-display span:first-child');

                    if (cardTimeline) cardTimeline.value = currentTime;
                    if (cardCurrentTimeEl) cardCurrentTimeEl.textContent = formatTime(currentTime);
                }
            });

            floatingAudio.addEventListener('loadedmetadata', () => {
                floatingTimeline.max = Math.floor(floatingAudio.duration);
                
                if (currentAudioCard) {
                    const totalDurationEl = currentAudioCard.querySelector('.time-display span:last-child');
                    const cardTimeline = currentAudioCard.querySelector('.timeline-slider');
                    
                    if (totalDurationEl) totalDurationEl.textContent = formatTime(floatingAudio.duration);
                    if (cardTimeline) cardTimeline.max = Math.floor(floatingAudio.duration);
                }
            });

            floatingTimeline.addEventListener('input', () => {
                floatingAudio.currentTime = floatingTimeline.value;
            });

            // Helper: set a card's thumbnail to its corresponding .gif (uses data-gif if present)
            function setThumbToGif(card) {
                if (!card) return;
                const img = card.querySelector('.audio-thumb');
                if (!img) return;
                // store original src
                if (!img.dataset.originalSrc) img.dataset.originalSrc = img.src;

                // determine gif src: prefer explicit data-gif, otherwise derive from original
                const gifSrc = img.dataset.gif || img.dataset.originalSrc.replace(/\.png(\?.*)?$/i, '.gif$1');

                // If gif already preloaded, switch immediately
                if (img.dataset.gifLoaded === '1') {
                    img.src = gifSrc;
                    return;
                }

                // Preload GIF and only swap if it loads successfully
                const pre = new Image();
                pre.onload = () => {
                    img.dataset.gifLoaded = '1';
                    img.src = gifSrc;
                };
                pre.onerror = () => {
                    img.dataset.gifLoaded = '0';
                };
                pre.src = gifSrc;
            }

            // Helper: revert a card thumbnail back to original png
            function revertThumbToPng(card) {
                if (!card) return;
                const img = card.querySelector('.audio-thumb');
                if (!img) return;
                if (img.dataset.originalSrc) {
                    img.src = img.dataset.originalSrc;
                } else {
                    img.src = img.src.replace(/\.gif(\?.*)?$/i, '.png$1');
                }
            }

            // Helper: revert thumbnails for all cards except the provided one
            function revertAllThumbsExcept(exceptCard) {
                document.querySelectorAll('.audio-card').forEach(card => {
                    if (card !== exceptCard) revertThumbToPng(card);
                });
            }
        }

        // applyOwnerGradients removed; owner-card background is plain black now

        // Helper functions
        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function extractTitleFromSrc(src) {
            return src.split('/').pop()
                .replace('.png', '')
                .replace(/%20/g, ' ')
                .replace(/\b\w/g, l => l.toUpperCase());
        }

        function skipBack(id) {
            const cardAudioElement = document.getElementById(id);
            if (!cardAudioElement) return;
            const card = cardAudioElement.closest('.audio-card');
            if (card === currentAudioCard && floatingAudio) {
                floatingAudio.currentTime = Math.max(0, floatingAudio.currentTime - 10);
            }
        }

        function skipForward(id) {
            const cardAudioElement = document.getElementById(id);
            if (!cardAudioElement) return;
            const card = cardAudioElement.closest('.audio-card');
            if (card === currentAudioCard && floatingAudio) {
                floatingAudio.currentTime = Math.min(floatingAudio.duration, floatingAudio.currentTime + 10);
            }
        }

        function setSpeed(id, speed) {
            const cardAudioElement = document.getElementById(id);
            if (!cardAudioElement) return;
            const card = cardAudioElement.closest('.audio-card');
            if (card === currentAudioCard && floatingAudio) {
                floatingAudio.playbackRate = speed;
            }
        }

        // Prevent right-click context menu
        document.addEventListener("contextmenu", e => e.preventDefault());
    </script>

<script>
(function (){
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwMq6blMRYNtXPmH0kTa0di6UG6dDnK8ljiyva5JxaHY5NkgV2IcSN_aHX6E0YmuPVI/exec";
  const PAGE_KEY = "pds_visit_start_" + location.pathname;
  let started = false;

  function getDeviceInfo() {
    const ua = navigator.userAgent || "";
    let deviceType = /mobile/i.test(ua) ? "Mobile" : /tablet/i.test(ua) ? "Tablet" : "Desktop";
    let os = "Unknown";
    if (/Windows/i.test(ua)) os = "Windows";
    else if (/Android/i.test(ua)) os = "Android";
    else if (/iPhone|iPad|iPod/i.test(ua)) os = "iOS";
    else if (/Macintosh|Mac OS X/i.test(ua)) os = "MacOS";
    else if (/Linux/i.test(ua)) os = "Linux";
    let browser = "Unknown";
    if (/Edg\//i.test(ua)) browser = "Edge";
    else if (/OPR\//i.test(ua) || /Opera/i.test(ua)) browser = "Opera";
    else if (/Chrome/i.test(ua) && !/Edg\//i.test(ua) && !/OPR\//i.test(ua)) browser = "Chrome";
    else if (/Safari/i.test(ua) && !/Chrome/i.test(ua)) browser = "Safari";
    else if (/Firefox/i.test(ua)) browser = "Firefox";
    const screenSize = (window.screen && window.screen.width) ? `${window.screen.width}x${window.screen.height}` : "";
    return { deviceType, os, browser, ua, screenSize };
  }

  function nowSeconds() { return Math.floor(Date.now()/1000); }

  function startTimerIfNeeded() {
    if (started) return;
    // Start only if name + roll exist (user unlocked)
    const name = localStorage.getItem("userName");
    const roll = localStorage.getItem("rollNumber");
    if (name && roll) {
      // save start time to sessionStorage so reload preserves time within same tab
      const existing = sessionStorage.getItem(PAGE_KEY);
      if (!existing) sessionStorage.setItem(PAGE_KEY, String(nowSeconds()));
      started = true;
    }
  }

  function getElapsedSeconds() {
    const s = sessionStorage.getItem(PAGE_KEY);
    if (!s) return 0;
    return Math.max(0, nowSeconds() - Number(s));
  }

  function clearTimer() {
    sessionStorage.removeItem(PAGE_KEY);
    started = false;
  }

  function sendLog(immediate=false) {
    // Send only if user has unlocked and we have some time
    const name = localStorage.getItem("userName") || "Guest";
    const roll = localStorage.getItem("rollNumber") || "Unknown";
    const timeSpent = getElapsedSeconds();
    if (timeSpent < 1 && !immediate) return;
    const device = getDeviceInfo();
    const params = new URLSearchParams();
    params.append("name", name);
    params.append("rollNumber", roll);
    params.append("page", location.pathname);
    params.append("timeSpent", String(timeSpent));
    params.append("deviceType", device.deviceType);
    params.append("os", device.os);
    params.append("browser", device.browser);
    params.append("screenSize", device.screenSize);

    try {
      if (navigator.sendBeacon) {
        const blob = new Blob([params.toString()], { type: 'application/x-www-form-urlencoded' });
        navigator.sendBeacon(WEB_APP_URL, blob);
      } else {
        fetch(WEB_APP_URL, { method: "POST", mode: "no-cors", headers: { "Content-Type": "application/x-www-form-urlencoded" }, body: params.toString() });
      }
    } catch (e) {
      try { fetch(WEB_APP_URL, { method: "POST", mode: "no-cors", body: params.toString() }); } catch(e2){}
    }
    // do not clear timer here; final clear happens on unload/pagehide
  }

  // When page is hidden (switch app/tab), send a snapshot (timer continues)
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      if (sessionStorage.getItem(PAGE_KEY)) sendLog(true);
    } else {
      startTimerIfNeeded();
    }
  }, false);

  // Final send on pagehide / beforeunload
  window.addEventListener("pagehide", function() {
    sendLog(true);
    clearTimer();
  }, false);

  window.addEventListener("beforeunload", function() {
    sendLog(true);
    clearTimer();
  }, false);

  // Expose control for other scripts if needed
  window.PDS_Tracking = {
    start: startTimerIfNeeded,
    sendNow: function(){ sendLog(true); },
    getElapsed: getElapsedSeconds
  };

  // Auto-start if unlocked already
  try { startTimerIfNeeded(); } catch(e){}

  // React to storage events (unlock from same/different tab)
  window.addEventListener('storage', function(e){
    if (e.key === "userName" || e.key === "rollNumber" || e.key === "followed_instagram") {
      startTimerIfNeeded();
    }
  }, false);

  // Safety poll: try to start for first 30 seconds in case unlock happens after small delay
  let pollCount = 0;
  const poll = setInterval(function(){
    startTimerIfNeeded();
    pollCount++;
    if (started || pollCount > 30) clearInterval(poll);
  }, 1000);

})();
</script>
   

<!-- END: PDS accurate tracking v2 -->



</body>
</html>


